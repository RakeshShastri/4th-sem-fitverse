<!doctype html>
<html lang="en">
  <head>
    <title>Fullsend</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  </head>
  <body>
    <!-- home css style -->
    <link rel="stylesheet" href="/drills/drill_wt.css">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src = "../login/login-check.js"></script>
   <script>
        fetch('http://localhost:8080/getUserList')
        .then((response) => response.json())
        .then((data) => createList(data));

        createList = (data) => {
            data.forEach(user => {
                createLine(user);
            });
        }

        createLine = (user) =>{
            var list = document.getElementById('list');
            var li = document.createElement('li');
            li.className = "list-group-item";
            li.innerHTML = `${user.email}&nbsp;&nbsp;`;
            var del = document.createElement('a');
            del.href = `/deleteUser?username=${user.email}`;
            del.text = "Delete\u00A0";
            del.style.color = "red";
            var btn = document.createElement('button');
            btn.textContent = "View Posts"
            btn.className = "btn btn-link";
            btn.addEventListener("click", (event) => {
                event.preventDefault();
                viewposts(user.email);
            });

            li.appendChild(btn);
            li.appendChild(del);
            list.appendChild(li);
        }

        viewposts = (user) => {
            fetch(`http://localhost:8080/getUserPosts?username=${user}`)
            .then((response) => response.json())
            .then((data) => showUserPosts(data));
            
            showUserPosts = (data) =>{
                data.forEach(data => {
                    mountCard(data);
                });
            }
            mountCard = (data) => {
                    let container = document.getElementById('mainContainer');
                    let rowOuter = document.createElement('div');
                    rowOuter.className = "row mt-3";
                    let col_1 =  document.createElement('div');
                    col_1.className = "col-12";
                    let card =  document.createElement('div');
                    card.className = "card shadow mg-b-20 mg-lg-b-25";
                    let cardHeader =  document.createElement('div');
                    cardHeader.className = "card-header";
                    cardHeader.style.backgroundColor = "#FF4433";
                    let rowInner_1 = document.createElement('div');
                    rowInner_1.className = "row";
                    let col_2 =  document.createElement('div');
                    col_2.className = "col-6";
                    let h =  document.createElement('h6');
                    h.className = "m-0 font-weight-bold text-white";
                    h.innerText = data.name;
                    let cardBody =  document.createElement('div');
                    cardBody.className = "card-body pd-20 pd-lg-25";
                    let rowInner_2 = document.createElement('div');
                    rowInner_2.className = "row g-0";
                    let col_3 =  document.createElement('div');
                    col_3.className = "col md-4";
                    let gif =  document.createElement('img');
                    gif.src = data.gifpath;
                    gif.style = "width: auto; height: 200px; margin: 28px;";
                    let col_4 =  document.createElement('div');
                    col_4.className = "col md-8";
                    let sr = document.createElement('p');
                    sr.innerHTML = `Sets: ${data.sets} <br><br> Reps: ${data.reps}`;
                    let delBtn = document.createElement('button');
                    delBtn.textContent = "DELETE POST";
                    delBtn.className = "btn btn-outline-danger";
                    delBtn.addEventListener("click", (event) => {
                         event.preventDefault();
                         deletepost(data);   
                        });

                    col_2.appendChild(h);
                    rowInner_1.appendChild(col_2);
                    cardHeader.appendChild(rowInner_1);

                    col_3.appendChild(gif);
                    col_4.appendChild(sr);
                    col_4.appendChild(delBtn);
                    rowInner_2.appendChild(col_3);
                    rowInner_2.appendChild(col_4);
                    cardBody.appendChild(rowInner_2);

                    card.appendChild(cardHeader);
                    card.appendChild(cardBody);

                    col_1.appendChild(card);
                    rowOuter.appendChild(col_1);

                    container.appendChild(rowOuter);

                    deletepost = (data) => {
                        fetch(`http://localhost:8080/deleteUserPosts?postname=${data.name}`);
                    }
            };
        }
    </script>
  <nav class="navbar navbar-expand-md nav-menu navbar-light bg-light sticky-top" >
    
    <a class="navbar-brand noline" href="/index.html"><img src="/images/fit-verse.png" alt="logo" style="width: 200px; padding: 5px;"></a>
    
    <button class="navbar-toggler noline" data-toggle="collapse" data-target="#collapse_target">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="collapse_target" style="border-bottom: no;">

      <ul class="navbar-nav mr-auto">
        <li class="nav-item  ">
            <a class="nav-link " href="/index.html"> HOME </a>
        </li>
          <li class="nav-item ">
              <a class="nav-link " href="/workouts.html">   WORKOUTS </a>
          </li>

          <li class="nav-item active dropdown">
             <a class="nav-link dropdown-toggle " data-toggle="dropdown" data-target="#drills_drop" href="#"> 
             DRILLS
             <span class="caret"></span>
            </a>
            <div class="dropdown-menu " aria-labelledby="drills_drop">
                <a class="dropsown-item noline" href="/drills/drill_hiit.html" style="text-decoration: none;">HIIT</a>
                <div class="dropdown-divider"></div>
                <a class="dropsown-item noline" href="/drills/drill_wt.html" style="text-decoration: none;">Weight Training</a>
                <div class="dropdown-divider"></div>
                <a class="dropsown-item noline" href="/drills/drill_yoga.html" style="text-decoration: none;">Yoga</a>
                <div class="dropdown-divider"></div>
                <a class="dropsown-item noline" href="/drills/drill_calis.html" style="text-decoration: none;">Calisthenics</a>
                <div class="dropdown-divider"></div>
                <a class="dropsown-item noline" href="/drills/drill_abs.html" style="text-decoration: none;">Abs</a>
                <div class="dropdown-divider"></div>
                <a class="dropsown-item noline" href="/drills/drills_user.html" style="text-decoration: none;">Custom Drills</a>
                
            </div>
          </li>
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown" data-target="#collec_drop" href="#"> 
            SPORTS
            <span class="caret"></span>
           </a>
           <div class="dropdown-menu" aria-labelledby="collec_drop">
            <a class="dropsown-item noline" href="/sports/foot.html" style="text-decoration: none;">Football</a>
            <div class="dropdown-divider"></div>
            <a class="dropsown-item noline" href="/sports/basket.html" style="text-decoration: none;">Basketball</a>
            <div class="dropdown-divider"></div>
            <a class="dropsown-item noline" href="/sports/cric.html" style="text-decoration: none; ">Cricket</a>
        </div>
          </li>
          
          <li></li>
      </ul>
      <a href="#" class="login-btn scrollto" style="text-decoration: none;" id = "loginbttn">LOG IN</a>
    </div>
  </nav>

  <div class="container" id = "mainContainer">
    <div class="row mt-3">
      <div class="col-12">
        <h1>Moderation Tools</h1>
      </div>
    </div>

    <ul class = "list-group" id = "list">USERS:
    </ul><br><br>
    
  
  </div>

  </body>


  </html>